(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-53196a64"],{"28a7":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("ccba"),o="undefined"!==typeof navigator&&!!navigator.userAgent,s=o&&navigator.userAgent.match(/Safari\//)&&!navigator.userAgent.match(/Chrome\//),a=o&&navigator.userAgent.match(/Edge\/1[2345]/),i=null;function u(){if(i)return i;var e=new Promise(function(e,t){function r(){e({u2f:null})}if(!o)return r();if(s)return r();var i="undefined"!==typeof window.u2f&&"function"===typeof window.u2f.sign;return i?e({u2f:window.u2f}):a?r():"http:"===location.protocol?r():"undefined"===typeof MessageChannel?r():void n.isSupported(function(t){t?e({u2f:n}):r()})}).then(function(t){return i=t.u2f?e:null,t});return e}function p(e,r){var n=null!=r?r.errorCode:1,o=t.ErrorNames[""+n],s=new Error(e);return s.metaData={type:o,code:n},s}function c(){return u().then(function(e){return!!e.u2f})}function d(e){if(!e.u2f){if("http:"===location.protocol)throw new Error("U2F isn't supported over http, only https");throw new Error("U2F not supported")}}function l(){return u().then(d)}function f(e){return null!=e&&Array.isArray(e)?e:null==e?[]:Array.isArray(e)?e.slice():[e]}function _(e,t,r){var n=f(e);"number"===typeof t&&"undefined"===typeof r&&(r=t,t=null);var o=f(t);return u().then(function(e){d(e);var t=e.u2f;return new Promise(function(e,s){function a(t){t.errorCode?s(p("Registration failed",t)):(delete t.errorCode,e(t))}var i=n[0].appId;t.register(i,n,o,a,r)})})}function g(e,t){var r=f(e);return u().then(function(e){d(e);var n=e.u2f;return new Promise(function(e,o){function s(t){t.errorCode?o(p("Sign failed",t)):(delete t.errorCode,e(t))}var a=r[0].appId,i=r[0].challenge,u=r.map(function(e){var t=e.version,r=e.keyHandle,n=e.appId;return{version:t,keyHandle:r,appId:n}});n.sign(a,i,u,s,t)})})}t.ErrorCodes={OK:0,OTHER_ERROR:1,BAD_REQUEST:2,CONFIGURATION_UNSUPPORTED:3,DEVICE_INELIGIBLE:4,TIMEOUT:5},t.ErrorNames={0:"OK",1:"OTHER_ERROR",2:"BAD_REQUEST",3:"CONFIGURATION_UNSUPPORTED",4:"DEVICE_INELIGIBLE",5:"TIMEOUT"},t.isSupported=c,t.ensureSupport=l,t.register=_,t.sign=g},4341:function(e,t,r){"use strict";function n(e){for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r])}Object.defineProperty(t,"__esModule",{value:!0});var o=r("28a7");n(r("28a7")),t.default=o},"6d14":function(e,t,r){"use strict";var n=r("7700"),o=r.n(n);o.a},7700:function(e,t,r){},"937c":function(e,t,r){"use strict";r.r(t);var n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("el-card",{staticClass:"box-card"},[r("div",{attrs:{slot:"header"},slot:"header"},[r("h3",[e._v("FIDO U2F register")])]),r("img",{attrs:{src:"/images/u2freg.png",alt:""}})])],1)],1),r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("center",[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.u2fregister}},[e._v(" 从服务器获取注册申请信息")])],1),r("span",[e._v("req data:")]),r("br"),r("textarea",{attrs:{name:"",id:"",readonly:""},domProps:{textContent:e._s(e.regreq)}})],1)],1),r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("br"),r("center",[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.clientgeneratekeys}},[e._v(" 客户端生成新的公私钥等信息")])],1),r("span",[e._v("客户端生成key 等信息:")]),r("br"),r("textarea",{attrs:{name:"",id:"",readonly:""},domProps:{textContent:e._s(e.reqclientgeneratekey)}})],1)],1),r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("br"),r("center",[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.u2fendregister}},[e._v(" 完成注册")])],1),r("span",[e._v("服务器返回的信息\n                "),r("br"),e._v("（public key 和 key handler 不需要返回 这里用于调试）:")]),r("br"),r("textarea",{attrs:{name:"",id:"",readonly:""},domProps:{textContent:e._s(e.regresponse)}})],1)],1),r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("el-card",{staticClass:"box-card"},[r("div",{attrs:{slot:"header"},slot:"header"},[r("h3",[e._v("FIDO U2F login")])]),r("img",{attrs:{src:"/images/u2flogin.png",alt:""}})])],1)],1),r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("center",[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.u2fauth}},[e._v(" 从服务器获取某用户的keyhandler")])],1),r("span",[e._v("req data:")]),r("br"),r("textarea",{attrs:{name:"",id:"",readonly:""},domProps:{textContent:e._s(e.authreq)}})],1)],1),r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("br"),r("center",[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.authclientsign}},[e._v(" 客户端对chanlleage进行签名")])],1),r("span",[e._v("客户端针对本次认证生成的签名信息:")]),r("br"),r("textarea",{attrs:{name:"",id:"",readonly:""},domProps:{textContent:e._s(e.authclientsignresult)}})],1)],1),r("el-row",[r("el-col",{attrs:{span:18,offset:3}},[r("br"),r("center",[r("el-button",{attrs:{type:"primary",size:"medium"},on:{click:e.u2fendrauth}},[e._v(" 完成认证")])],1),r("span",[e._v("服务器返回的信息:")]),r("br"),r("textarea",{attrs:{name:"",id:"",readonly:""},domProps:{textContent:e._s(e.authresponse)}})],1)],1)],1)},o=[],s=r("4341"),a=r.n(s),i=r("bc3a"),u=r.n(i),p={data:function(){return{regreq:"test",reqclientgeneratekey:"test2",regresponse:"test3",authreq:"test4",authclientsignresult:"test5",authresponse:"test6"}},methods:{u2fregister:function(){var e=this;console.log("u2fregister"),u.a.get("https://172.16.64.92:4430/u2f/reg").then(function(t){e.regreq=t.data}).catch(function(e){alert(e)})},clientgeneratekeys:function(){var e=this;alert("please insert u2f key，灯闪烁的时候，用手指触摸卡上的金属区域"),console.log("u2f device over register");var t=this.regreq.registrationRequest;a.a.register(t).then(function(t){console.log("u2f device over register"),e.reqclientgeneratekey=t}).catch(function(e){alert(e)})},u2fendregister:function(){var e=this,t=this.reqclientgeneratekey;u.a.post("https://172.16.64.92:4430/u2f/reg",{registrationResponse:t}).then(function(t){e.regresponse=t.data,console.log(t.data)}).catch(function(e){console.log(e),alert(e)})},u2fauth:function(){var e=this;u.a.get("https://172.16.64.92:4430/u2f/auth").then(function(t){e.authreq=t.data}).catch(function(e){alert(e)})},authclientsign:function(){var e=this;alert("please insert u2f key，灯闪烁的时候，用手指触摸卡上的金属区域");var t=this.authreq.authRequest;a.a.sign(t).then(function(t){e.authclientsignresult=t}).catch(function(e){alert(e)})},u2fendrauth:function(){var e=this,t=this.authclientsignresult;u.a.post("https://172.16.64.92:4430/u2f/auth",{authResponse:t}).then(function(t){e.authresponse=t.data,console.log(t.data)}).catch(function(e){console.log(e),alert(e)})}},mounted:function(){console.log("ok")}},c=p,d=(r("6d14"),r("2877")),l=Object(d["a"])(c,n,o,!1,null,"3564bffa",null);t["default"]=l.exports},ccba:function(e,t,r){"use strict";var n,o=o||{};e.exports=o,o.EXTENSION_ID="kmendfapggjehodndflmmgagdbamhnfd",o.MessageTypes={U2F_REGISTER_REQUEST:"u2f_register_request",U2F_REGISTER_RESPONSE:"u2f_register_response",U2F_SIGN_REQUEST:"u2f_sign_request",U2F_SIGN_RESPONSE:"u2f_sign_response",U2F_GET_API_VERSION_REQUEST:"u2f_get_api_version_request",U2F_GET_API_VERSION_RESPONSE:"u2f_get_api_version_response"},o.ErrorCodes={OK:0,OTHER_ERROR:1,BAD_REQUEST:2,CONFIGURATION_UNSUPPORTED:3,DEVICE_INELIGIBLE:4,TIMEOUT:5},o.U2fRequest,o.U2fResponse,o.Error,o.Transport,o.Transports,o.SignRequest,o.SignResponse,o.RegisterRequest,o.RegisterResponse,o.RegisteredKey,o.GetJsApiVersionResponse,o.getMessagePort=function(e){if("undefined"!=typeof chrome&&chrome.runtime){var t={type:o.MessageTypes.U2F_SIGN_REQUEST,signRequests:[]};chrome.runtime.sendMessage(o.EXTENSION_ID,t,function(){chrome.runtime.lastError?o.getIframePort_(e):o.getChromeRuntimePort_(e)})}else o.isAndroidChrome_()?o.getAuthenticatorPort_(e):o.isIosChrome_()?o.getIosPort_(e):o.getIframePort_(e)},o.isAndroidChrome_=function(){var e=navigator.userAgent;return-1!=e.indexOf("Chrome")&&-1!=e.indexOf("Android")},o.isIosChrome_=function(){return["iPhone","iPad","iPod"].indexOf(navigator.platform)>-1},o.getChromeRuntimePort_=function(e){var t=chrome.runtime.connect(o.EXTENSION_ID,{includeTlsChannelId:!0});setTimeout(function(){e(new o.WrappedChromeRuntimePort_(t))},0)},o.getAuthenticatorPort_=function(e){setTimeout(function(){e(new o.WrappedAuthenticatorPort_)},0)},o.getIosPort_=function(e){setTimeout(function(){e(new o.WrappedIosPort_)},0)},o.WrappedChromeRuntimePort_=function(e){this.port_=e},o.formatSignRequest_=function(e,t,r,s,a){if(void 0===n||n<1.1){for(var i=[],u=0;u<r.length;u++)i[u]={version:r[u].version,challenge:t,keyHandle:r[u].keyHandle,appId:e};return{type:o.MessageTypes.U2F_SIGN_REQUEST,signRequests:i,timeoutSeconds:s,requestId:a}}return{type:o.MessageTypes.U2F_SIGN_REQUEST,appId:e,challenge:t,registeredKeys:r,timeoutSeconds:s,requestId:a}},o.formatRegisterRequest_=function(e,t,r,s,a){if(void 0===n||n<1.1){for(var i=0;i<r.length;i++)r[i].appId=e;var u=[];for(i=0;i<t.length;i++)u[i]={version:t[i].version,challenge:r[0],keyHandle:t[i].keyHandle,appId:e};return{type:o.MessageTypes.U2F_REGISTER_REQUEST,signRequests:u,registerRequests:r,timeoutSeconds:s,requestId:a}}return{type:o.MessageTypes.U2F_REGISTER_REQUEST,appId:e,registerRequests:r,registeredKeys:t,timeoutSeconds:s,requestId:a}},o.WrappedChromeRuntimePort_.prototype.postMessage=function(e){this.port_.postMessage(e)},o.WrappedChromeRuntimePort_.prototype.addEventListener=function(e,t){var r=e.toLowerCase();"message"==r||"onmessage"==r?this.port_.onMessage.addListener(function(e){t({data:e})}):console.error("WrappedChromeRuntimePort only supports onMessage")},o.WrappedAuthenticatorPort_=function(){this.requestId_=-1,this.requestObject_=null},o.WrappedAuthenticatorPort_.prototype.postMessage=function(e){var t=o.WrappedAuthenticatorPort_.INTENT_URL_BASE_+";S.request="+encodeURIComponent(JSON.stringify(e))+";end";document.location=t},o.WrappedAuthenticatorPort_.prototype.getPortType=function(){return"WrappedAuthenticatorPort_"},o.WrappedAuthenticatorPort_.prototype.addEventListener=function(e,t){var r=e.toLowerCase();if("message"==r){var n=this;window.addEventListener("message",n.onRequestUpdate_.bind(n,t),!1)}else console.error("WrappedAuthenticatorPort only supports message")},o.WrappedAuthenticatorPort_.prototype.onRequestUpdate_=function(e,t){var r=JSON.parse(t.data),n=(r["intentURL"],r["errorCode"],null);r.hasOwnProperty("data")&&(n=JSON.parse(r["data"])),e({data:n})},o.WrappedAuthenticatorPort_.INTENT_URL_BASE_="intent:#Intent;action=com.google.android.apps.authenticator.AUTHENTICATE",o.WrappedIosPort_=function(){},o.WrappedIosPort_.prototype.postMessage=function(e){var t=JSON.stringify(e),r="u2f://auth?"+encodeURI(t);location.replace(r)},o.WrappedIosPort_.prototype.getPortType=function(){return"WrappedIosPort_"},o.WrappedIosPort_.prototype.addEventListener=function(e,t){var r=e.toLowerCase();"message"!==r&&console.error("WrappedIosPort only supports message")},o.getIframePort_=function(e){var t="chrome-extension://"+o.EXTENSION_ID,r=document.createElement("iframe");r.src=t+"/u2f-comms.html",r.setAttribute("style","display:none"),document.body.appendChild(r);var n=new MessageChannel,s=function(t){"ready"==t.data?(n.port1.removeEventListener("message",s),e(n.port1)):console.error('First event on iframe port was not "ready"')};n.port1.addEventListener("message",s),n.port1.start(),r.addEventListener("load",function(){r.contentWindow.postMessage("init",t,[n.port2])})},o.EXTENSION_TIMEOUT_SEC=30,o.port_=null,o.waitingForPort_=[],o.reqCounter_=0,o.callbackMap_={},o.getPortSingleton_=function(e){o.port_?e(o.port_):(0==o.waitingForPort_.length&&o.getMessagePort(function(e){o.port_=e,o.port_.addEventListener("message",o.responseHandler_);while(o.waitingForPort_.length)o.waitingForPort_.shift()(o.port_)}),o.waitingForPort_.push(e))},o.responseHandler_=function(e){var t=e.data,r=t["requestId"];if(r&&o.callbackMap_[r]){var n=o.callbackMap_[r];delete o.callbackMap_[r],n(t["responseData"])}else console.error("Unknown or missing requestId in response.")},o.isSupported=function(e){var t=!1;function r(r){t||(t=!0,e(r))}o.getApiVersion(function(e){n=void 0===e["js_api_version"]?0:e["js_api_version"],r(!0)}),setTimeout(r.bind(null,!1),1500)},o.sign=function(e,t,r,s,a){void 0===n?o.getApiVersion(function(i){n=void 0===i["js_api_version"]?0:i["js_api_version"],console.log("Extension JS API Version: ",n),o.sendSignRequest(e,t,r,s,a)}):o.sendSignRequest(e,t,r,s,a)},o.sendSignRequest=function(e,t,r,n,s){o.getPortSingleton_(function(a){var i=++o.reqCounter_;o.callbackMap_[i]=n;var u="undefined"!==typeof s?s:o.EXTENSION_TIMEOUT_SEC,p=o.formatSignRequest_(e,t,r,u,i);a.postMessage(p)})},o.register=function(e,t,r,s,a){void 0===n?o.getApiVersion(function(i){n=void 0===i["js_api_version"]?0:i["js_api_version"],console.log("Extension JS API Version: ",n),o.sendRegisterRequest(e,t,r,s,a)}):o.sendRegisterRequest(e,t,r,s,a)},o.sendRegisterRequest=function(e,t,r,n,s){o.getPortSingleton_(function(a){var i=++o.reqCounter_;o.callbackMap_[i]=n;var u="undefined"!==typeof s?s:o.EXTENSION_TIMEOUT_SEC,p=o.formatRegisterRequest_(e,r,t,u,i);a.postMessage(p)})},o.getApiVersion=function(e,t){o.getPortSingleton_(function(r){if(r.getPortType){var n;switch(r.getPortType()){case"WrappedIosPort_":case"WrappedAuthenticatorPort_":n=1.1;break;default:n=0;break}e({js_api_version:n})}else{var s=++o.reqCounter_;o.callbackMap_[s]=e;var a={type:o.MessageTypes.U2F_GET_API_VERSION_REQUEST,timeoutSeconds:"undefined"!==typeof t?t:o.EXTENSION_TIMEOUT_SEC,requestId:s};r.postMessage(a)}})}}}]);
//# sourceMappingURL=chunk-53196a64.d24baae2.js.map